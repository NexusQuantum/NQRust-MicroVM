{{- /*
  Custom image render hook for docs section
  This ensures baseURL is properly included in ALL image paths
  Overrides theme's default render hook
*/ -}}
{{ $dest := .Destination }}
{{ $text := .PlainText }}
{{ $title := .Title }}
{{ $url := urls.Parse $dest }}

{{- /* Check if it's an external URL (has scheme like http://, https://) */ -}}
{{ $isExternal := $url.Scheme }}

{{- /* For external URLs, keep as-is. For local paths, use relURL */ -}}
{{ $imageSrc := $dest }}
{{ if not $isExternal }}
  {{ $imageSrc = $dest | relURL }}
{{ end }}

{{ if $title }}
  <figure>
    <img src="{{ $imageSrc | safeURL }}" alt="{{ $text }}" loading="lazy">
    <figcaption>{{ $title | markdownify }}</figcaption>
  </figure>
{{ else }}
  <img src="{{ $imageSrc | safeURL }}" alt="{{ $text }}" loading="lazy">
{{ end }}
